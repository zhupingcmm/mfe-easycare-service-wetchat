<!--index.wxml-->
<navigation-bar title="ç”Ÿè‚²æœåŠ¡" back="{{false}}" color="black" background="#FFF"></navigation-bar>
<scroll-view class="scrollarea" scroll-y type="list">
  <view class="container">
    <view class="tab-buttons">
      <view 
        class="tab-button {{activeTab === 'maternity' ? 'active' : ''}}"
        bindtap="switchTab"
        data-tab="maternity"
      >
        <text class="tab-icon">ğŸ“…</text>
        <text class="tab-text">äº§å‡è®¡ç®—</text>
      </view>
      <view 
        class="tab-button {{activeTab === 'allowance' ? 'active' : ''}}"
        bindtap="switchTab"
        data-tab="allowance"
      >
        <text class="tab-icon">ğŸ’°</text>
        <text class="tab-text">æ´¥è´´è®¡ç®—</text>
      </view>
    </view>

    <!-- äº§å‡è®¡ç®—è¡¨å• -->
    <view class="content-area" wx:if="{{activeTab === 'maternity'}}">
      <view class="form-section">
        <view class="form-title">åŸºæœ¬ä¿¡æ¯</view>

        <view class="form-item">
          <text class="label"><text class="required">*</text>åŸå¸‚</text>
          <picker 
            mode="selector" 
            range="{{cityNames}}" 
            value="{{cityIndex}}" 
            bindchange="onCityChange"
            disabled="{{loadingCities}}"
          >
            <view class="picker">
              {{loadingCities ? 'åŠ è½½ä¸­...' : (cityName || 'è¯·é€‰æ‹©åŸå¸‚')}}
            </view>
          </picker>
        </view>

        <view class="form-item">
          <text class="label"><text class="required">*</text>é¢„äº§æœŸ</text>
          <picker mode="date" value="{{expectedDeliveryDate}}" bindchange="onExpectedDeliveryDateChange">
            <view class="picker">
              {{expectedDeliveryDate || 'è¯·é€‰æ‹©é¢„äº§æœŸ'}}
            </view>
          </picker>
        </view>

        <view class="form-item">
          <text class="label"><text class="required">*</text>å©´å„¿æ•°é‡</text>
          <picker 
            mode="selector" 
            range="{{babyCountOptions}}" 
            value="{{babyCountIndex}}" 
            bindchange="onNumberOfBabiesChange"
          >
            <view class="picker">
              {{numberOfBabies}}ä¸ª
            </view>
          </picker>
        </view>
      </view>

      <view class="form-section">
        <view class="form-title">å‡æœŸç±»å‹</view>

        <view class="form-item-switch">
          <text class="label">æ˜¯å¦æœ‰æ™šè‚²å‡/ç”Ÿè‚²å‡/å¥–åŠ±å‡</text>
          <switch checked="{{hasExtendedDays}}" bindchange="onHasExtendedDaysChange" />
        </view>

        <view class="form-item-switch">
          <text class="label">æ˜¯å¦éš¾äº§</text>
          <switch checked="{{isDifficultBirth}}" bindchange="onIsDifficultBirthChange" />
        </view>

        <view class="form-item-switch">
          <text class="label">æ˜¯å¦æµäº§</text>
          <switch checked="{{isMiscarriage}}" bindchange="onIsMiscarriageChange" />
        </view>
      </view>

      <view class="button-group">
        <button class="btn btn-primary" bindtap="calculateMaternity">è®¡ç®—äº§å‡</button>
        <button class="btn btn-secondary" bindtap="resetMaternity">é‡ç½®</button>
      </view>

      <view class="result-section" wx:if="{{showMaternityResult && maternityResult}}">
        <view class="result-title">è®¡ç®—ç»“æœ</view>
        <view class="result-card">
          <view class="result-item">
            <text class="result-label">æ€»å¤©æ•°</text>
            <text class="result-value">{{maternityResult.totalDays}}å¤©</text>
          </view>
          <view class="result-item">
            <text class="result-label">å¼€å§‹æ—¥æœŸ</text>
            <text class="result-value">{{maternityResult.startDate}}</text>
          </view>
          <view class="result-item">
            <text class="result-label">ç»“æŸæ—¥æœŸ</text>
            <text class="result-value">{{maternityResult.endDate}}</text>
          </view>
          <view class="result-item">
            <text class="result-label">è¿”å²—æ—¥æœŸ</text>
            <text class="result-value">{{maternityResult.returnToWorkDate}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ´¥è´´è®¡ç®—è¡¨å• -->
    <view class="content-area" wx:if="{{activeTab === 'allowance'}}">
      <view class="form-section">
        <view class="form-title">æ”¶å…¥ä¿¡æ¯</view>
        
        <view class="form-item">
          <text class="label">å¹³å‡å·¥èµ„ï¼ˆå…ƒ/æœˆï¼‰</text>
          <input 
            class="input" 
            type="digit" 
            placeholder="è¯·è¾“å…¥å¹³å‡å·¥èµ„" 
            value="{{avgSalary}}"
            bindinput="onAvgSalaryInput"
          />
        </view>

        <view class="form-item">
          <text class="label">ç¤¾ä¿ç¼´è´¹åŸºæ•°ï¼ˆå…ƒï¼‰</text>
          <input 
            class="input" 
            type="digit" 
            placeholder="é€‰å¡«ï¼Œé»˜è®¤ä¸ºå¹³å‡å·¥èµ„" 
            value="{{socialSecurityBase}}"
            bindinput="onSocialSecurityBaseInput"
          />
        </view>

        <view class="form-item">
          <text class="label">è¿ç»­ç¼´è´¹æœˆæ•°</text>
          <input 
            class="input" 
            type="number" 
            placeholder="è¯·è¾“å…¥ç¼´è´¹æœˆæ•°" 
            value="{{monthsWorked}}"
            bindinput="onMonthsWorkedInput"
          />
        </view>
      </view>

      <view class="button-group">
        <button class="btn btn-primary" bindtap="calculateAllowance">è®¡ç®—æ´¥è´´</button>
        <button class="btn btn-secondary" bindtap="resetAllowance">é‡ç½®</button>
      </view>

      <view class="result-section" wx:if="{{showAllowanceResult && allowanceResult}}">
        <view class="result-title">è®¡ç®—ç»“æœ</view>
        <view class="result-card">
          <view class="result-item">
            <text class="result-label">é¢„è®¡æ€»æ´¥è´´</text>
            <text class="result-value highlight">Â¥{{allowanceResult.totalAmount}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</scroll-view>
